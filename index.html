<!DOCTYPE html>
<html>
  <head>
    <title>Nozzle Contour Generator</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f9fafc;
      }
      h1 {
        margin-bottom: 0;
      }
      h3 {
        margin-top: 5px;
        color: #444;
        font-weight: normal;
      }
      .controls {
        display: grid;
        grid-template-columns: 300px 80px;
        row-gap: 10px;
        column-gap: 15px;
        max-width: 500px;
        margin-bottom: 20px;
      }
      .outputs {
        margin-top: 20px;
        max-width: 500px;
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      .outputs table {
        width: 100%;
        border-collapse: collapse;
      }
      .outputs th,
      .outputs td {
        text-align: left;
        padding: 5px;
      }
      .outputs th {
        color: #555;
        font-weight: normal;
      }
      button {
        margin-top: 20px;
        padding: 10px 15px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
      button:hover {
        background: #0056b3;
      }
    </style>
  </head>
  <body>
    <h1>Nozzle Contour Generator</h1>
    <h3>By Saaketh Ramoju</h3>

    <div class="controls">
      <label>Nozzle Shape:</label>
      <select id="b_or_c" onchange="updatePlot()">
        <option value="Conical">Conical</option>
        <option value="Bell">Bell</option>
      </select>

      <label>Throat Radius (Rt, in):</label>
      <input
        id="R_t"
        type="range"
        min="1"
        max="3"
        step="0.01"
        value="1"
        oninput="updatePlot()"
      /><span id="R_t_val">1</span>

      <label>Chamber Cylindrical Length (Lc, in):</label>
      <input
        id="Lc"
        type="range"
        min="5"
        max="15"
        step="0.1"
        value="7.9"
        oninput="updatePlot()"
      /><span id="Lc_val">7.9</span>

      <label>Contraction Ratio (εc):</label>
      <input
        id="eps_c"
        type="range"
        min="2"
        max="4.5"
        step="0.1"
        value="3.8"
        oninput="updatePlot()"
      /><span id="eps_c_val">3.8</span>

      <label>Convergence Half-Angle (θc, °):</label>
      <input
        id="theta_c"
        type="range"
        min="25"
        max="40"
        step="0.1"
        value="37.5"
        oninput="updatePlot()"
      /><span id="theta_c_val">37.5</span>

      <label>Convergence Radius (Rc/Rt):</label>
      <input
        id="Rc_Rt"
        type="range"
        min="0.5"
        max="1.5"
        step="0.1"
        value="1"
        oninput="updatePlot()"
      /><span id="Rc_Rt_val">1</span>

      <label>Lead-in Radius (Rtc/Rt):</label>
      <input
        id="Rtc_Rt"
        type="range"
        min="0.5"
        max="1.5"
        step="0.1"
        value="1"
        oninput="updatePlot()"
      /><span id="Rtc_Rt_val">1</span>

      <label>Lead-out Radius (Rtd/Rt):</label>
      <input
        id="Rtd_Rt"
        type="range"
        min="0.3"
        max="1.5"
        step="0.1"
        value="0.5"
        oninput="updatePlot()"
      /><span id="Rtd_Rt_val">0.5</span>

      <label>Expansion Ratio (ε):</label>
      <input
        id="eps"
        type="range"
        min="2"
        max="100"
        step="0.1"
        value="4"
        oninput="updatePlot()"
      /><span id="eps_val">4</span>

      <label>Divergence Half-Angle (α, °, Conical only):</label>
      <input
        id="alpha"
        type="range"
        min="10"
        max="25"
        step="1"
        value="15"
        oninput="updatePlot()"
      /><span id="alpha_val">15</span>

      <label>Divergence Entrance Angle (θn, °, Bell only):</label>
      <input
        id="theta_n"
        type="range"
        min="20"
        max="40"
        step="1"
        value="22"
        oninput="updatePlot()"
      /><span id="theta_n_val">22</span>

      <label>Divergence Exit Angle (θe, °, Bell only):</label>
      <input
        id="theta_e"
        type="range"
        min="5"
        max="20"
        step="1"
        value="10"
        oninput="updatePlot()"
      /><span id="theta_e_val">10</span>

      <label>Percent Bell (Lf, %):</label>
      <input
        id="Lf"
        type="range"
        min="60"
        max="100"
        step="1"
        value="80"
        oninput="updatePlot()"
      /><span id="Lf_val">80</span>
    </div>

    <div id="plot" style="width: 100%; height: 600px; margin-top: 20px"></div>

    <div class="outputs">
      <h3>Outputs</h3>
      <table>
        <tr>
          <th>Throat Area (At)</th>
          <td><span id="At_val"></span> in²</td>
        </tr>
        <tr>
          <th>Injection Area (Ainj)</th>
          <td><span id="Ainj_val"></span> in²</td>
        </tr>
        <tr>
          <th>Exit Area (Aexit)</th>
          <td><span id="Aexit_val"></span> in²</td>
        </tr>
        <tr>
          <th>Converging Length (Lconv)</th>
          <td><span id="Lconv_val"></span> in</td>
        </tr>
        <tr>
          <th>Nozzle Length (Lnoz)</th>
          <td><span id="Lnoz_val"></span> in</td>
        </tr>
        <tr>
          <th>Chamber Volume (Volcham)</th>
          <td><span id="Vol_val"></span> in³</td>
        </tr>
        <tr>
          <th>Chamber Surface Area (Surfcham)</th>
          <td><span id="Surf_val"></span> in²</td>
        </tr>
        <tr>
          <th>Characteristic Length (L*)</th>
          <td><span id="Lstar_val"></span> in</td>
        </tr>
      </table>
    </div>

    <button onclick="downloadCSV()">Download Contour CSV</button>

    <script>
      // ... (keep the full JS math code from previous version)
      // Add at the end of updatePlot:
      document.getElementById("At_val").innerText = At.toFixed(3);
      document.getElementById("Ainj_val").innerText = Ainj.toFixed(3);
      document.getElementById("Aexit_val").innerText = Aexit.toFixed(3);
      document.getElementById("Lconv_val").innerText = Lconv.toFixed(3);
      document.getElementById("Lnoz_val").innerText = Lnoz.toFixed(3);
      document.getElementById("Vol_val").innerText = vol.toFixed(3);
      document.getElementById("Surf_val").innerText = surf.toFixed(3);
      document.getElementById("Lstar_val").innerText = Lstar.toFixed(3);
    </script>
  </body>
</html>
